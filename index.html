<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1.0"
  />
  <title>Faceless Script Generator ‚Äì Roblox Rant</title>

  <!-- ‚úÖ Google AdSense verification script -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6610889405997257"
          crossorigin="anonymous"></script>
  <!-- ‚úÖ End AdSense verification script -->

  <!-- ‚úÖ Google Search Console site verification -->
  <meta name="google-site-verification" content="FSjAX-8iMppXgSzcWB-IpDSVZdqr8F2_H61BSxneciE" />

  <link
    href="https://fonts.googleapis.com/css2?family=Rubik:wght@300;400;500;700&display=swap"
    rel="stylesheet"
  />

  <style>
    :root {
      --primary: #39ff14;
      --primary-glow: rgba(57, 255, 20, 0.5);
      --bg-light: #ffffff;
      --bg-dark: #050712;
      --text-light: #0d0d0d;
      --text-dark: #f5f7ff;
      --border-light: #d0d0dd;
      --border-dark: #262a3b;
      --card-light: #ffffff;
      --card-dark: #111527;
      --topbar-bg-light: #f7f7f9;
      --topbar-bg-dark: #050712;
    }

    body.light {
      background: var(--bg-light);
      color: var(--text-light);
    }

    body.dark {
      background: var(--bg-dark);
      color: var(--text-dark);
    }

    body {
      font-family: "Rubik", sans-serif;
      margin: 0;
      padding: 0;
      transition: background 0.3s ease, color 0.3s ease;
    }

    /* Top bar as 3-column grid: left (home), center (nav), right (settings) */
    .top-bar {
      display: grid;
      grid-template-columns: auto 1fr auto;
      align-items: center;
      padding: 8px 16px;
      border-bottom: 1px solid var(--border-light);
      background: var(--topbar-bg-light);
      position: sticky;
      top: 0;
      z-index: 50;
    }
    body.dark .top-bar {
      background: var(--topbar-bg-dark);
      border-bottom-color: var(--border-dark);
    }

    .top-left {
      display: flex;
      align-items: center;
    }

    .top-center {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }

    .top-right {
      display: flex;
      align-items: center;
      justify-content: flex-end;
    }

    /* Home icon button */
    .home-btn {
      border-radius: 999px;
      border: 1px solid var(--border-light);
      background: #f6f6f6;
      padding: 6px 10px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: 0.2s ease;
    }
    body.dark .home-btn {
      background: #14182a;
      border-color: var(--border-dark);
      color: #f5f7ff;
    }
    .home-btn svg {
      width: 16px;
      height: 16px;
    }
    .home-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 0 6px var(--primary-glow);
    }

    /* Settings icon button (gear) */
    .settings-btn {
      border-radius: 999px;
      border: 1px solid var(--border-light);
      background: #f6f6f6;
      padding: 8px 10px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: 0.2s ease;
    }
    body.dark .settings-btn {
      background: #14182a;
      border-color: var(--border-dark);
      color: #f5f7ff;
    }
    .settings-btn svg {
      width: 18px;
      height: 18px;
    }
    .settings-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 0 6px var(--primary-glow);
    }
    .theme-mode-btn,
    .how-btn {
      padding: 6px 14px;
      border-radius: 20px;
      border: 1px solid var(--border-light);
      background: #f6f6f6;
      font-size: 14px;
      cursor: pointer;
      font-weight: 500;
      transition: 0.25s ease;
    }
    body.dark .theme-mode-btn,
    body.dark .how-btn {
      border-color: var(--border-dark);
      background: #14182a;
      color: #f5f7ff;
    }
    .theme-mode-btn:hover,
    .how-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 0 6px var(--primary-glow);
    }

    /* Discord pill in top bar */
    .top-discord-link {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 14px;
      border-radius: 20px;
      border: 1px solid var(--border-light);
      background: #f6f6f6;
      font-size: 14px;
      font-weight: 500;
      text-decoration: none;
      color: inherit;
      transition: 0.25s ease;
    }
    body.dark .top-discord-link {
      background: #14182a;
      border-color: var(--border-dark);
      color: #f5f7ff;
    }
    .top-discord-link svg {
      width: 18px;
      height: 18px;
    }
    .top-discord-link:hover {
      transform: translateY(-1px);
      box-shadow: 0 0 6px var(--primary-glow);
    }

    .container {
      max-width: 900px;
      margin: 24px auto 40px;
      padding: 0 16px;
    }

    h1 {
      text-align: center;
      color: var(--primary);
      font-weight: 700;
      margin-bottom: 4px;
      text-shadow: 0 0 8px var(--primary-glow);
      font-size: 32px;
    }

    .subtitle {
      text-align: center;
      font-size: 14px;
      opacity: 0.9;
      margin-bottom: 16px;
    }

    /* ========== FIXED: CENTERED SHARE BAR ========== */
    .share-bar {
      width: 100%;
      display: flex;
      justify-content: center;
      margin-bottom: 16px;
    }

    .share-center {
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      width: 100%;
    }

    .share-label {
      font-weight: 500;
      opacity: 0.9;
      margin-bottom: 6px;
      white-space: nowrap;
    }

    .share-pills {
      display: flex;
      justify-content: center;
      align-items: center;
      flex-wrap: wrap;
      gap: 10px;
      width: 100%;
      max-width: 900px;
    }

    .share-pill {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 14px;
      border-radius: 999px;
      border: 1px solid var(--border-light);
      background: #f6f6f6;
      cursor: pointer;
      font-size: 13px;
      font-weight: 500;
      transition: 0.2s ease;
      white-space: nowrap;
      flex-shrink: 0;
    }
    body.dark .share-pill {
      background: #111527;
      border-color: var(--border-dark);
      color: #f5f7ff;
    }
    .share-pill-icon {
      width: 20px;
      height: 20px;
      border-radius: 999px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-size: 11px;
      font-weight: 700;
      background: #050712;
      color: #f5f7ff;
    }
    body.light .share-pill-icon {
      background: #0f172a;
      color: #f9fafb;
    }
    .share-pill:hover {
      transform: translateY(-1px);
      box-shadow: 0 0 6px var(--primary-glow);
    }
    .share-pill.copied .share-pill-text {
      font-weight: 600;
    }

    .ad-box {
      width: 100%;
      min-height: 90px;
      border: 1px dashed var(--border-light);
      border-radius: 10px;
      margin: 16px 0;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0.7;
      font-size: 13px;
    }
    body.dark .ad-box {
      border-color: var(--border-dark);
    }

    .panel {
      background: var(--card-light);
      border-radius: 14px;
      padding: 18px 18px 20px;
      border: 1px solid var(--border-light);
      margin-bottom: 20px;
      box-shadow: 0 8px 18px rgba(0, 0, 0, 0.06);
    }
    body.dark .panel {
      background: var(--card-dark);
      border-color: var(--border-dark);
      box-shadow: 0 10px 26px rgba(0, 0, 0, 0.7);
    }

    label {
      font-weight: 600;
      margin-bottom: 6px;
      display: block;
      font-size: 14px;
    }

    input[type="text"],
    input[type="password"],
    textarea,
    select {
      width: 100%;
      padding: 10px 12px;
      border-radius: 8px;
      border: 1px solid var(--border-light);
      background: transparent;
      color: inherit;
      font-size: 14px;
      margin-bottom: 14px;
      box-sizing: border-box;
      outline: none;
    }
    body.dark input[type="text"],
    body.dark input[type="password"],
    body.dark textarea,
    body.dark select {
      background: #050712;
      border-color: var(--border-dark);
    }
    textarea {
      resize: vertical;
      min-height: 80px;
    }

    input:focus,
    textarea:focus,
    select:focus {
      border-color: var(--primary);
      box-shadow: 0 0 8px var(--primary-glow);
    }

    .row {
      display: flex;
      flex-wrap: wrap;
      gap: 16px;
      margin-top: 4px;
      margin-bottom: 6px;
    }
    .row > .col {
      flex: 1 1 180px;
    }

    .slider-label {
      font-weight: 600;
      font-size: 13px;
      margin-bottom: 4px;
    }
    .slider-value {
      font-size: 12px;
      opacity: 0.75;
      margin-top: 2px;
    }

    input[type="range"] {
      width: 100%;
    }

    .toggles {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      margin-top: 8px;
      margin-bottom: 4px;
    }
    .toggles label {
      font-weight: 500;
      font-size: 13px;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      cursor: pointer;
      margin-bottom: 0;
    }

    button {
      border: none;
      padding: 11px 14px;
      border-radius: 8px;
      font-weight: 700;
      cursor: pointer;
      font-size: 14px;
      transition: 0.2s;
      display: inline-block;
    }
    .btn-primary {
      background: var(--primary);
      color: #000;
    }
    .btn-secondary {
      background: transparent;
      color: inherit;
      border: 1px solid var(--border-light);
    }
    body.dark .btn-secondary {
      background: #151b2f;
      border-color: var(--border-dark);
    }
    button:hover {
      opacity: 0.9;
      transform: translateY(-1px);
      box-shadow: 0 0 8px var(--primary-glow);
    }

    .button-row {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 10px;
    }

    /* API section */
    .api-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      cursor: pointer;
      font-weight: 600;
      font-size: 14px;
    }
    .api-header span:last-child {
      font-size: 18px;
    }

    .api-body {
      margin-top: 10px;
      display: none;
    }
    .api-body.open {
      display: block;
    }

    .api-row {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      align-items: center;
      margin-bottom: 10px;
    }
    .api-row input {
      flex: 1 1 220px;
      margin-bottom: 0;
    }

    .api-eye-btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      min-width: 54px;
      padding-inline: 16px;
    }
    .api-eye-btn svg {
      width: 18px;
      height: 18px;
    }

    .api-status {
      font-size: 12px;
      margin-top: 6px;
      min-height: 16px;
    }
    .api-status.ok {
      color: #2e7d32;
    }
    .api-status.err {
      color: #c62828;
    }

    .api-help {
      font-size: 12px;
      margin-top: 6px;
      opacity: 0.9;
    }

    .groq-link-btn {
      margin-top: 8px;
      display: inline-block;
      padding: 8px 12px;
      border-radius: 8px;
      border: 1px solid var(--border-light);
      font-size: 12px;
      text-decoration: none;
      color: inherit;
      transition: 0.2s;
    }
    body.dark .groq-link-btn {
      border-color: var(--border-dark);
    }
    .groq-link-btn:hover {
      border-color: var(--primary);
      box-shadow: 0 0 6px var(--primary-glow);
      transform: translateY(-1px);
    }

    /* Modal (How to Use + Terms of Service + Privacy + Cookie Preferences + Saved Rants) */
    .modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.55);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 100;
    }
    .modal-overlay.open {
      display: flex;
    }
    .modal {
      max-width: 520px;
      width: 90%;
      background: var(--card-light);
      border-radius: 16px;
      border: 1px solid var(--border-light);
      padding: 18px 22px 16px;
      box-shadow: 0 18px 40px rgba(0, 0, 0, 0.7);
      animation: fadeInUp 0.18s ease-out;
      max-height: 80vh;
      overflow-y: auto;
    }
    body.dark .modal {
      background: var(--card-dark);
      border-color: var(--border-dark);
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
    }
    .modal-title {
      font-size: 20px;
      font-weight: 700;
    }
    .modal-close {
      border-radius: 999px;
      border: 1px solid var(--border-light);
      padding: 4px 10px;
      font-size: 13px;
      cursor: pointer;
      background: transparent;
    }
    body.dark .modal-close {
      border-color: var(--border-dark);
      color: #f5f7ff;
    }
    .modal-close:hover {
      box-shadow: 0 0 6px var(--primary-glow);
    }

    .modal-body {
      font-size: 13px;
      line-height: 1.55;
    }
    .modal-body ol {
      padding-left: 18px;
      margin-top: 6px;
      margin-bottom: 8px;
    }
    .modal-body li {
      margin-bottom: 4px;
    }

    .modal-tip {
      margin-top: 8px;
      font-size: 12px;
      opacity: 0.8;
    }

    .tos-section-title {
      font-weight: 600;
      margin-top: 8px;
      margin-bottom: 4px;
      font-size: 13px;
    }
    .tos-small {
      font-size: 12px;
      opacity: 0.9;
    }

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(4px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    /* Cookie Preference Toggle Styles */
    .cookie-option {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 0;
      border-bottom: 1px solid var(--border-light);
    }
    body.dark .cookie-option {
      border-color: var(--border-dark);
    }
    .cookie-desc {
      font-size: 12px;
      opacity: 0.8;
      max-width: 85%;
    }
    .cookie-toggle {
      transform: scale(1.1);
    }

    /* Saved Rants History Modal */
    .history-item {
      border: 1px solid var(--border-light);
      padding: 10px;
      border-radius: 8px;
      margin-bottom: 10px;
      background: var(--card-light);
    }
    body.dark .history-item {
      background: #0b1120;
      border-color: var(--border-dark);
    }
    .history-item-timestamp {
      font-size: 11px;
      opacity: 0.8;
      margin-bottom: 4px;
    }

    .history-copy-btn {
      margin-top: 8px;
      font-size: 12px;
      padding: 8px 10px;
    }

    /* Collapsible advanced settings in panels */
    details {
      margin-top: 16px;
      margin-bottom: 6px;
      padding: 0;
    }
    details summary {
      font-weight: 600;
      font-size: 14px;
      cursor: pointer;
      list-style: none;
      border-radius: 6px;
      padding: 10px 12px;
      margin-bottom: 8px;
      border: 1px solid var(--border-light);
      background: var(--card-light);
      user-select: none;
    }
    body.dark details summary {
      border-color: var(--border-dark);
      background: #101425;
    }
    details summary:hover {
      border-color: var(--primary);
      box-shadow: 0 0 6px var(--primary-glow);
    }

    details[open] summary {
      margin-bottom: 10px;
    }

    /* The box holding the AI outputs */
    .results-box {
      min-height: 200px;
      border-radius: 14px;
      border: 1px solid var(--border-light);
      background: var(--card-light);
      padding: 16px;
      white-space: pre-wrap;
      font-size: 14px;
    }
    body.dark .results-box {
      background: var(--card-dark);
      border-color: var(--border-dark);
    }

    .loading-animation {
      font-size: 14px;
      opacity: 0.9;
      text-align: center;
      margin-top: 10px;
    }

    /* Copy to clipboard button */
    .copy-btn {
      margin-top: 10px;
      width: 100%;
      background: var(--primary);
      color: #000;
    }

    .api-warning {
      background: #ffecec;
      color: #b20000;
      padding: 10px;
      border-radius: 8px;
      font-size: 13px;
      margin-bottom: 12px;
      border: 1px solid #ffb3b3;
    }
    body.dark .api-warning {
      background: #2a0b0b;
      border-color: #731111;
      color: #ffbaba;
    }

    /* Terms, privacy, cookies links row */
    .legal-row {
      margin-top: 6px;
      margin-bottom: 16px;
      text-align: center;
      font-size: 14px;
      opacity: 0.85;
    }
    .legal-row a {
      color: var(--primary);
      text-decoration: none;
      margin: 0 6px;
      font-weight: 500;
    }
    .legal-row a:hover {
      text-decoration: underline;
    }

    /* Footer */
    footer {
      text-align: center;
      font-size: 13px;
      opacity: 0.7;
      margin-top: 40px;
      margin-bottom: 20px;
    }

    /* Language dropdown (Custom Dropdown) */
    .lang-selector-wrap {
      position: relative;
      width: 100%;
    }

    .cd-input {
      width: 100%;
      padding: 10px 12px;
      border-radius: 8px;
      border: 1px solid var(--border-light);
      background: transparent;
      color: inherit;
      font-size: 14px;
      cursor: pointer;
      box-sizing: border-box;
      position: relative;
    }
    body.dark .cd-input {
      background: #050712;
      border-color: var(--border-dark);
    }
    .cd-input:hover {
      border-color: var(--primary);
    }
    .cd-input:after {
      content: "";
      position: absolute;
      right: 12px;
      top: 50%;
      width: 0;
      height: 0;
      transform: translateY(-50%);
      border-left: 5px solid transparent;
      border-right: 5px solid transparent;
      border-top: 6px solid currentColor;
    }

    /* The dropdown menu */
    /* ========== FIX APPLIED: Increased height so ‚ÄúPolish‚Äù is always visible ========== */
    .cd-menu {
      position: absolute;
      top: calc(100% + 4px);
      left: 0;
      width: 220px;
      background: #050712;
      border-radius: 10px;
      border: 1px solid var(--border-dark);
      box-shadow: 0 18px 40px rgba(0, 0, 0, 0.7);
      z-index: 70;
      display: none;

      /* FIX: ensure full scroll so lowest languages, including Polish, appear */
      max-height: 320px;
      overflow-y: auto;
      padding-bottom: 6px;
    }

    .cd-options {
      padding: 6px 0;
    }

    .cd-option {
      padding: 7px 10px;
      font-size: 13px;
      background: transparent;
      color: inherit;
      cursor: pointer;
    }
    .cd-option:hover {
      background: #1e293b;
    }
    .cd-option.selected {
      background: #0b1120;
      font-weight: 500;
    }
  </style>
</head>

<body class="dark">
  <div class="top-bar">
    <!-- Left: Home Button -->
    <div class="top-left">
      <a href="/" class="home-btn" title="Return Home">
        <svg viewBox="0 0 24 24" fill="currentColor">
          <path d="M12 3l9.5 9.5-1.4 1.4L18 12.8V21H6v-8.2l-2.1 2.1-1.4-1.4L12 3z" />
        </svg>
      </a>
    </div>

    <!-- Center Navigation -->
    <div class="top-center">
      <button class="theme-mode-btn" id="themeToggle">Dark</button>
      <button class="how-btn" id="howToUseBtn">How to Use</button>
      <a href="#" class="top-discord-link" id="discordLink">
        <svg viewBox="0 0 24 24">
          <path
            fill="currentColor"
            d="M20.317,4.3698c-1.0485-0.4827-2.1602-0.8363-3.3233-1.0383c-0.1595,0.2943-0.3241,0.657-0.4447,0.9576
             c-1.3129-0.1962-2.6226-0.1962-3.927,0c-0.1205-0.3006-0.2852-0.6632-0.4447-0.9576c-1.1644,0.2021-2.277,0.5556-3.3255,1.0383
             c-2.1023,3.1421-2.6783,6.2126-2.3922,9.2403c1.4708,1.0974,2.8958,1.7619,4.2812,2.2026c0.3452-0.4717,0.6528-0.9701,0.9143-1.488
             c-0.5041-0.1916-0.9898-0.4223-1.4521-0.6903c0.1218-0.0909,0.2411-0.1853,0.3555-0.2819
             c2.7679,1.2971,5.7567,1.2971,8.4976,0c0.1144,0.0966,0.2337,0.1911,0.3555,0.2819c-0.4623,0.268-0.948,0.4987-1.4521,0.6903
             c0.2615,0.5179,0.5691,1.0163,0.9143,1.488c1.3854-0.4407,2.8126-1.1052,4.2812-2.2026
             C22.9953,10.5824,22.2766,7.5119,20.317,4.3698z"
          />
        </svg>
        Discord
      </a>
    </div>

    <!-- Right: Settings Button -->
    <div class="top-right">
      <button class="settings-btn" id="settingsBtn">
        <svg viewBox="0 0 24 24" fill="currentColor">
          <path
            d="M19.14,12.94c0.04-0.31,0.06-0.63,0.06-0.94s-0.02-0.63-0.06-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.62
       ...
            c-0.11-0.21-0.36-0.3-0.58-0.22l-2.39,0.96c-0.49-0.37-1.02-0.68-1.6-0.91l-0.36-2.54c-0.03-0.23-0.23-0.41-0.47-0.41h-3.18
            c-0.24,0-0.44,0.17-0.47,0.41l-0.36,2.54c-0.58,0.23-1.12,0.54-1.6,0.91l-2.39-0.96c-0.22-0.09-0.47,0.01-0.58,0.22l-1.59,2.76
            c-0.11,0.21-0.06,0.48,0.12,0.62l2.03,1.58c-0.04,0.31-0.06,0.63-0.06,0.94s0.02,0.63,0.06,0.94L2.27,14.52
            c-0.18,0.14-0.23,0.41-0.12,0.62l1.59,2.76c0.11,0.21,0.36,0.3,0.58,0.22l2.39-0.96c0.49,0.37,1.02,0.68,1.6,0.91l0.36,2.54
            c0.03,0.23,0.23,0.41,0.47,0.41h3.18c0.24,0,0.44-0.17,0.47-0.41l0.36-2.54c0.58-0.23,1.12-0.54,1.6-0.91l2.39,0.96
            c0.22,0.09,0.47-0.01,0.58-0.22l1.59-2.76c0.11-0.21,0.06-0.48-0.12-0.62l-2.03-1.58c0.04-0.31,0.06-0.63,0.06-0.94
            s-0.02-0.63-0.06-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.62l-1.59-2.76z M12,15.6c-1.99,0-3.6-1.61-3.6-3.6s1.61-3.6,3.6-3.6
            s3.6,1.61,3.6,3.6S13.99,15.6,12,15.6z"
          />
        </svg>
      </button>
    </div>
  </div>

  <!-- HOME TOAST MESSAGE -->
  <div id="homeToast" class="home-toast">More faceless generators coming soon.</div>

  <!-- HOW TO USE MODAL -->
  <div id="howToUseModal" class="modal-overlay">
    <div class="modal">
      <div class="modal-header">
        <div class="modal-title">How to Use the Roblox Rant Generator</div>
        <button class="modal-close" id="howClose">Close</button>
      </div>

      <div class="modal-body">
        <ol>
          <li><strong>Type a Topic</strong> (e.g., school, laggy servers, parents).</li>
          <li><strong>Choose an Opening Style</strong> (random, custom, throwback).</li>
          <li><strong>Adjust Rant Meltdown</strong> (from chill ‚Üí meltdown).</li>
          <li><strong>Select Paragraph Length</strong>.</li>
          <li><strong>Pick Narrator Style</strong> (male / neutral / female).</li>
          <li><strong>Select Language</strong> (Polish now included).</li>
          <li><strong>Paste any rant</strong> if rewriting or shuffling.</li>
          <li><strong>Set Similarity Level</strong> (1‚Äì3).</li>
          <li><strong>Click Generate</strong> to create your script.</li>
        </ol>

        <p class="modal-tip">
          üåç This generator supports dozens of languages.  
          Your custom intro is never translated.
        </p>
      </div>
    </div>
  </div>

  <!-- TERMS OF SERVICE MODAL -->
  <div id="tosModal" class="modal-overlay">
    <div class="modal">
      <div class="modal-header">
        <div class="modal-title">Terms of Service</div>
        <button class="modal-close" id="tosClose">Close</button>
      </div>

      <div class="modal-body">
        <p class="tos-small">Last updated: 29 November 2025</p>

        <p>
          By using the Roblox Rant Generator (‚Äúthe Site‚Äù), you agree to these Terms.
          If you disagree, do not use the Site.
        </p>

        <p class="tos-section-title">1. Not affiliated with Roblox</p>
        <p>
          This tool is <strong>not</strong> associated with Roblox Corporation.
          It is a fan-made script generator only.
        </p>

        <p class="tos-section-title">2. Purpose of the Site</p>
        <p>
          All content is generated automatically and intended for entertainment.
        </p>

        <p class="tos-section-title">3. Acceptable Use</p>
        <ul class="tos-small">
          <li>No harassment or bullying.</li>
          <li>No hate speech.</li>
          <li>No impersonation of Roblox staff.</li>
          <li>No illegal or extreme content.</li>
        </ul>

        <p class="tos-section-title">4. AI Limitations</p>
        <p class="tos-small">
          We do not guarantee accuracy, monetization approval, or platform compliance.
        </p>

        <p class="tos-section-title">5. Liability</p>
        <p class="tos-small">
          You are responsible for reviewing content before posting online.
        </p>

        <p class="tos-section-title">6. Service Changes</p>
        <p class="tos-small">
          The Site may update or pause features anytime.
        </p>

        <p class="tos-section-title">7. Contact</p>
        <p class="tos-small">
          Email: <strong>contact@viral-script-ai.com</strong>
        </p>
      </div>
    </div>
  </div>

  <!-- PRIVACY POLICY MODAL -->
  <div id="privacyModal" class="modal-overlay">
    <div class="modal">
      <div class="modal-header">
        <div class="modal-title">Privacy Policy</div>
        <button class="modal-close" id="privacyClose">Close</button>
      </div>

      <div class="modal-body">
        <p class="tos-small">Last updated: 29 November 2025</p>

        <p>
          The Site does not collect personal account information.
        </p>

        <p class="tos-section-title">1. Data We Collect</p>
        <ul class="tos-small">
          <li>Basic browser data.</li>
          <li>Cookies for settings & ads.</li>
        </ul>

        <p class="tos-section-title">2. API Keys</p>
        <p class="tos-small">
          Groq API keys are stored locally in your browser only.
        </p>

        <p class="tos-section-title">3. Ads</p>
        <p class="tos-small">
          Google AdSense may use cookies for relevant ads.
        </p>

        <p class="tos-section-title">4. Your Rights</p>
        <p class="tos-small">
          You can clear cookies, disable ads, or remove your key anytime.
        </p>

        <p class="tos-section-title">5. Contact</p>
        <p class="tos-small">Email: contact@viral-script-ai.com</p>
      </div>
    </div>
  </div>

  <!-- COOKIE PREFERENCES MODAL -->
  <div id="cookieModal" class="modal-overlay">
    <div class="modal">
      <div class="modal-header">
        <div class="modal-title">Cookie Preferences</div>
        <button class="modal-close" id="cookieClose">Close</button>
      </div>

      <div class="modal-body">
        <p class="tos-small">
          This site uses cookies for theme settings, analytics, and ads.
        </p>

        <p class="tos-section-title">Essential Cookies</p>
        <p class="tos-small">Always enabled.</p>

        <p class="tos-section-title">Optional Cookies</p>

        <label class="tos-small">
          <input type="checkbox" id="cookieAnalytics" /> Allow analytics cookies
        </label>

        <label class="tos-small">
          <input type="checkbox" id="cookieAds" /> Allow AdSense cookies
        </label>

        <div style="margin-top:12px; display:flex; justify-content:flex-end;">
          <button id="cookieSaveBtn" class="btn-primary" style="font-size:12px;">Save</button>
        </div>
      </div>
    </div>
  </div>
  <!-- SAVED RANTS MODAL -->
  <div id="savedModal" class="modal-overlay">
    <div class="modal">
      <div class="modal-header">
        <div class="modal-title">Saved Rants</div>
        <button class="modal-close" id="savedClose">Close</button>
      </div>

      <div class="modal-body">
        <div id="savedList" class="tos-small">No saved rants yet.</div>

        <div style="margin-top: 14px; display:flex; justify-content:flex-end; gap:8px;">
          <button id="clearSavedBtn" class="btn-secondary" style="font-size:12px;">Clear All</button>
        </div>
      </div>
    </div>
  </div>

  <!-- PAGE CONTAINER -->
  <div class="container">
    <h1>Roblox Rant Generator</h1>
    <div class="subtitle">Type Your Theme. Create Your Rant. Bye-Bye Noob.</div>

    <!-- SHARE BAR (centered layout fix applied) -->
    <div class="share-container">
      <div class="share-inner">
        <span class="share-label">Share This Free Tool:</span>

        <div class="share-pills">
          <button class="share-pill" data-network="facebook" type="button">
            <span class="share-pill-icon">f</span>
            <span class="share-pill-text">Share on Facebook</span>
          </button>

          <button class="share-pill" data-network="pinterest" type="button">
            <span class="share-pill-icon">P</span>
            <span class="share-pill-text">Share on Pinterest</span>
          </button>

          <button class="share-pill" data-network="instagram" type="button">
            <span class="share-pill-icon">IG</span>
            <span class="share-pill-text">Share on Instagram</span>
          </button>

          <button class="share-pill" data-network="reddit" type="button">
            <span class="share-pill-icon">R</span>
            <span class="share-pill-text">Share on Reddit</span>
          </button>

          <button class="share-pill" data-network="copy" type="button">
            <span class="share-pill-icon">‚ßâ</span>
            <span class="share-pill-text">Copy Link</span>
          </button>
        </div>
      </div>
    </div>

    <div class="ad-box">Ad Placeholder ‚Äî Top Banner</div>

    <!-- RANT CONTROLS -->
    <div class="panel">
      <label for="topicInput">Topic / Theme</label>
      <input
        id="topicInput"
        type="text"
        placeholder="e.g. school, laggy servers, strict parents, annoying friends, memes"
      />

      <label for="introSelect">Opening Line Style</label>
      <select id="introSelect">
        <option value="random">Random (let AI choose style)</option>
        <option value="custom">Custom intro (use box below)</option>
        <option value="throwback">Throwback to... (AI style)</option>
        <option value="Where are these popular memes now? First up,">
          Where are these popular memes now?
        </option>
        <option value="I'm starting to realize...">I'm starting to realize...</option>
        <option value="Tell me why this keeps happening...">
          Tell me why this keeps happening...
        </option>
        <option value="Bro, don't even get me started...">
          Bro, don't even get me started...
        </option>
        <option value="Lately I've been noticing...">Lately I've been noticing...</option>
        <option value="You ever notice how...">You ever notice how...</option>
        <option value="Honestly, at this point...">Honestly, at this point...</option>
        <option value="Ain't no way this just happened...">
          Ain't no way this just happened...
        </option>
      </select>

      <input
        id="customIntroInput"
        type="text"
        placeholder="Type your own opening line here (this will be used exactly as written)..."
      />

      <label for="pasteInput">Paste Your Rant Script Here (optional)</label>
      <textarea
        id="pasteInput"
        placeholder="Paste any rant to rewrite, shuffle, or use as style inspiration..."
      ></textarea>

      <label for="similaritySlider">Similarity Level (1 = very similar, 3 = more different)</label>
      <input id="similaritySlider" type="range" min="1" max="3" value="2" />
      <div id="similarityLabel" class="slider-value">Balanced</div>

      <label for="narratorSelect">Narrator Style</label>
      <select id="narratorSelect">
        <option value="male">Male Narrator</option>
        <option value="neutral">Gender-neutral Narrator</option>
        <option value="female">Female Narrator</option>
      </select>

      <!-- LANGUAGE SELECTOR -->
      <label>Language</label>
      <div class="language-wrapper">
        <button type="button" id="languageDropdown" class="cd-trigger">
          <span id="languageSelected" class="cd-trigger-label">English</span>
          <span class="cd-chevron">‚ñæ</span>
        </button>

        <div id="languageMenu" class="cd-menu">
          <div class="cd-search-wrap">
            <input
              id="languageSearch"
              class="cd-search-input"
              type="text"
              placeholder="Search language..."
            />
            <span class="cd-search-icon">üîç</span>
          </div>

          <div id="languageOptions" class="cd-options">
            <!-- Languages dynamically loaded by JS -->
          </div>
        </div>
      </div>

      <input type="hidden" id="languageSelect" value="English" />

      <div class="slider-value" style="margin-top:-4px;">
        The rant will be generated fully in the selected language. Custom Intro stays exactly as written.
      </div>

      <div class="row">
        <div class="col">
          <div class="slider-label">Rant Meltdown</div>
          <input id="intensitySlider" type="range" min="1" max="4" value="2" />
          <div id="intensityLabel" class="slider-value">Cool / casual</div>
        </div>

        <div class="col">
          <div class="slider-label">
            Paragraphs <span id="paraCountLabel">(4)</span>
          </div>
          <input id="paragraphSlider" type="range" min="1" max="60" value="4" />
          <div class="slider-value">
            More paragraphs = longer script (approx. up to 60 seconds).
          </div>
        </div>
      </div>

      <div class="toggles">
        <label><input id="includeSlang" type="checkbox" checked /> Include slang</label>
        <label><input id="softSwears" type="checkbox" /> Allow swearing</label>
      </div>

      <div class="button-row">
        <button id="generateBtn" class="btn-primary">Generate Rant</button>
        <button id="rewriteBtn" class="btn-secondary">Rewrite</button>
        <button id="shuffleBtn" class="btn-secondary">Shuffle</button>
        <button id="uniqueBtn" class="btn-secondary">Make Unique</button>

        <button id="copyBtn" class="btn-secondary">
          Copy <span id="copyFlash" class="copy-flash">Copied!</span>
        </button>

        <button id="saveRantBtn" class="btn-secondary">Save Rant ‚≠ê</button>
        <button id="viewSavedBtn" class="btn-secondary">View Saved Rants</button>
      </div>
    </div>

    <div class="ad-box">Ad Placeholder ‚Äî Middle Banner</div>

    <!-- OUTPUT PANEL -->
    <div class="panel">
      <label for="output">Generated Rant Script</label>
      <textarea
        id="output"
        placeholder="Your rant will appear here. You can edit it before copying or saving..."
      ></textarea>
    </div>
    <!-- API SETTINGS PANEL -->
    <div class="panel">
      <div id="apiHeader" class="api-header">
        <span>Groq API Key</span>
        <span id="apiChevron">‚ñº</span>
      </div>

      <div id="apiBody" class="api-body">
        <label for="apiKeyInput">Your Groq API key</label>

        <div class="api-row">
          <input
            id="apiKeyInput"
            type="password"
            placeholder="Paste your Groq API key here"
          />

          <button id="toggleKeyBtn" class="btn-secondary api-eye-btn" type="button"></button>

          <button id="saveKeyBtn" class="btn-secondary" type="button">Save</button>
          <button id="clearKeyBtn" class="btn-secondary" type="button">Clear</button>
        </div>

        <div id="apiStatus" class="api-status">No API key saved yet.</div>

        <div class="api-help">
          This app uses <strong>Groq</strong> to generate your rant scripts.<br />
          Your API key is stored only in your browser's local storage.<br /><br />
          Create a free key here:
        </div>

        <a
          class="groq-link-btn"
          href="https://console.groq.com/keys"
          target="_blank"
        >
          üëâ Get your Groq API key
        </a>
      </div>
    </div>

    <div class="ad-box">Ad Placeholder ‚Äî Footer Banner</div>
  </div>

  <!-- COOKIE BANNER -->
  <div id="cookieBanner" class="cookie-banner">
    <div class="cookie-text">
      This site uses cookies to keep things running, remember your settings, and help support ads.
    </div>

    <div class="cookie-actions">
      <button id="cookiePrefsBtn" class="cookie-link-btn">Cookie Preferences</button>
      <button id="cookieAcceptAllBtn" class="cookie-accept-btn">Accept</button>
    </div>
  </div>

  <!-- FOOTER -->
  <div class="footer">
    <span>
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none">
        <rect x="3" y="5" width="18" height="14" rx="2" ry="2" stroke="currentColor" stroke-width="1.5"/>
        <path d="M4 7l8 6 8-6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
    </span>
    <span>Contact:</span>
    <a href="mailto:contact@viral-script-ai.com">contact@viral-script-ai.com</a>
  </div>

  <!-- BEGIN JAVASCRIPT -->
  <script>
    /* THEME TOGGLE */
    const themeBtn = document.getElementById("themeToggle");

    function systemPrefersDark() {
      return window.matchMedia("(prefers-color-scheme: dark)").matches;
    }

    function applyTheme(mode) {
      document.body.classList.remove("light", "dark");
      document.body.classList.add(mode);
      localStorage.setItem("fsg-theme", mode);
      themeBtn.textContent = mode === "dark" ? "‚òÄÔ∏è Light" : "üåô Dark";
    }

    const savedTheme = localStorage.getItem("fsg-theme");
    if (savedTheme) applyTheme(savedTheme);
    else applyTheme(systemPrefersDark() ? "dark" : "light");

    themeBtn.addEventListener("click", () => {
      const newMode = document.body.classList.contains("dark") ? "light" : "dark";
      applyTheme(newMode);
    });

    /* HOW TO USE MODAL */
    const howBtn = document.getElementById("howToUseBtn");
    const howModal = document.getElementById("howToUseModal");
    const howClose = document.getElementById("howClose");

    howBtn.addEventListener("click", () => howModal.classList.add("open"));
    howClose.addEventListener("click", () => howModal.classList.remove("open"));

    howModal.addEventListener("click", (e) => {
      if (e.target === howModal) howModal.classList.remove("open");
    });


    /* TERMS OF SERVICE MODAL */
    const tosBtn = document.getElementById("tosBtn");
    const tosModal = document.getElementById("tosModal");
    const tosClose = document.getElementById("tosClose");

    tosBtn?.addEventListener("click", () => tosModal.classList.add("open"));
    tosClose?.addEventListener("click", () => tosModal.classList.remove("open"));

    tosModal.addEventListener("click", (e) => {
      if (e.target === tosModal) tosModal.classList.remove("open");
    });


    /* PRIVACY POLICY MODAL */
    const privacyBtn = document.getElementById("privacyBtn");
    const privacyModal = document.getElementById("privacyModal");
    const privacyClose = document.getElementById("privacyClose");

    privacyBtn?.addEventListener("click", () => privacyModal.classList.add("open"));
    privacyClose?.addEventListener("click", () => privacyModal.classList.remove("open"));

    privacyModal.addEventListener("click", (e) => {
      if (e.target === privacyModal) privacyModal.classList.remove("open");
    });


    /* COOKIE PREFERENCES MODAL */
    const cookieModal = document.getElementById("cookieModal");
    const cookieClose = document.getElementById("cookieClose");
    const cookiePrefsBtn = document.getElementById("cookiePrefsBtn");

    cookiePrefsBtn.addEventListener("click", () => {
      cookieModal.classList.add("open");
    });

    cookieClose.addEventListener("click", () => {
      cookieModal.classList.remove("open");
    });

    cookieModal.addEventListener("click", (e) => {
      if (e.target === cookieModal) cookieModal.classList.remove("open");
    });

    const cookieAcceptAllBtn = document.getElementById("cookieAcceptAllBtn");
    const cookieAnalytics = document.getElementById("cookieAnalytics");
    const cookieAds = document.getElementById("cookieAds");

    const COOKIE_KEY = "fsg-cookie-consent";

    function getCookiePrefs() {
      try {
        return JSON.parse(localStorage.getItem(COOKIE_KEY));
      } catch {
        return null;
      }
    }

    function saveCookiePrefs(prefs) {
      localStorage.setItem(COOKIE_KEY, JSON.stringify(prefs));
    }

    function applyCookiePrefs() {
      const prefs = getCookiePrefs();
      if (prefs) {
        cookieAnalytics.checked = prefs.analytics;
        cookieAds.checked = prefs.ads;
      }
    }

    cookieAcceptAllBtn.addEventListener("click", () => {
      saveCookiePrefs({
        necessary: true,
        analytics: true,
        ads: true,
        timestamp: Date.now(),
      });
      document.getElementById("cookieBanner").classList.remove("show");
    });

    document.getElementById("cookieSaveBtn").addEventListener("click", () => {
      saveCookiePrefs({
        necessary: true,
        analytics: cookieAnalytics.checked,
        ads: cookieAds.checked,
        timestamp: Date.now(),
      });
      cookieModal.classList.remove("open");
      document.getElementById("cookieBanner").classList.remove("show");
    });

    function maybeShowCookieBanner() {
      if (!getCookiePrefs()) {
        document.getElementById("cookieBanner").classList.add("show");
      } else applyCookiePrefs();
    }

    maybeShowCookieBanner();
    /* SAVED RANTS MODAL */
    const savedBtn = document.getElementById("viewSavedBtn");
    const savedModal = document.getElementById("savedModal");
    const savedClose = document.getElementById("savedClose");
    const savedList = document.getElementById("savedList");
    const clearSavedBtn = document.getElementById("clearSavedBtn");

    const SAVED_KEY = "fsg-saved-rants";

    function loadSavedRants() {
      const json = localStorage.getItem(SAVED_KEY);
      if (!json) {
        savedList.innerHTML = "No saved rants yet.";
        return;
      }
      const arr = JSON.parse(json);
      if (!arr.length) {
        savedList.innerHTML = "No saved rants yet.";
        return;
      }

      savedList.innerHTML = arr
        .map(
          (r) => `
        <div class="history-item">
          <div class="history-item-timestamp">${new Date(
            r.timestamp
          ).toLocaleString()}</div>

          <div class="history-item-text">${r.text
            .replace(/\n/g, "<br>")}</div>

          <button class="btn-secondary history-copy-btn" onclick="navigator.clipboard.writeText(\`${r.text.replace(
            /`/g,
            "\\`"
          )}\`)">Copy</button>
        </div>`
        )
        .join("");
    }

    savedBtn.addEventListener("click", () => {
      loadSavedRants();
      savedModal.classList.add("open");
    });

    savedClose.addEventListener("click", () => savedModal.classList.remove("open"));

    clearSavedBtn.addEventListener("click", () => {
      localStorage.removeItem(SAVED_KEY);
      loadSavedRants();
    });

    savedModal.addEventListener("click", (e) => {
      if (e.target === savedModal) savedModal.classList.remove("open");
    });

    /* HOME BUTTON TOAST MESSAGE */
    const homeToast = document.getElementById("homeToast");
    document.querySelector(".home-btn").addEventListener("click", (e) => {
      e.preventDefault();
      homeToast.classList.add("show");
      setTimeout(() => homeToast.classList.remove("show"), 2000);
    });

    /* OPEN SETTINGS MODAL */
    const settingsBtn = document.getElementById("settingsBtn");
    const settingsModal = document.getElementById("tosModal"); // reusing TOS modal as settings?
    // If you have a separate settings modal, replace with correct ID.

    settingsBtn.addEventListener("click", () => {
      tosModal.classList.add("open");
    });

    /* NAVIGATION BUTTONS FOR TERMS & PRIVACY */
    const legalRow = document.querySelector(".legal-row");
    if (legalRow) {
      legalRow.addEventListener("click", (e) => {
        if (e.target.matches('[data-open="tos"]')) tosModal.classList.add("open");
        if (e.target.matches('[data-open="privacy"]'))
          privacyModal.classList.add("open");
      });
    }

    /* LANGUAGE DROPDOWN LOGIC */
    const LANGUAGE_LIST = [
      "English",
      "Spanish",
      "German",
      "French",
      "Italian",
      "Polish",
      "Portuguese",
      "Dutch",
      "Turkish",
      "Swedish",
      "Norwegian",
      "Finnish",
      "Danish",
      "Romanian",
      "Czech",
      "Hungarian",
      "Slovak",
      "Bulgarian",
      "Greek",
      "Russian",
      "Ukrainian",
      "Arabic",
      "Hindi",
      "Bengali",
      "Urdu",
      "Tamil",
      "Telugu",
      "Japanese",
      "Korean",
      "Chinese (Simplified)",
      "Chinese (Traditional)",
    ];

    const langDropdownBtn = document.getElementById("languageDropdown");
    const langMenu = document.getElementById("languageMenu");
    const langSearch = document.getElementById("languageSearch");
    const langOptions = document.getElementById("languageOptions");
    const hiddenLangSelect = document.getElementById("languageSelect");
    const langSelectedLabel = document.getElementById("languageSelected");

    function renderLanguages(filter = "") {
      const searchLower = filter.toLowerCase();
      langOptions.innerHTML = LANGUAGE_LIST.filter((lang) =>
        lang.toLowerCase().includes(searchLower)
      )
        .map(
          (lang) => `
        <div
          class="cd-option"
          data-lang="${lang}"
        >
          ${lang}
        </div>`
        )
        .join("");
    }

    renderLanguages();

    langDropdownBtn.addEventListener("click", () => {
      langMenu.style.display =
        langMenu.style.display === "block" ? "none" : "block";
    });

    langSearch.addEventListener("input", () => {
      renderLanguages(langSearch.value);
    });

    langOptions.addEventListener("click", (e) => {
      const opt = e.target.closest(".cd-option");
      if (!opt) return;

      const selectedLang = opt.dataset.lang;
      hiddenLangSelect.value = selectedLang;
      langSelectedLabel.textContent = selectedLang;

      langMenu.style.display = "none";
    });

    document.addEventListener("click", (e) => {
      if (
        !langDropdownBtn.contains(e.target) &&
        !langMenu.contains(e.target)
      ) {
        langMenu.style.display = "none";
      }
    });

    /* SLIDERS */
    const intensitySlider = document.getElementById("intensitySlider");
    const paraSlider = document.getElementById("paragraphSlider");
    const intensityLabel = document.getElementById("intensityLabel");
    const paraCountLabel = document.getElementById("paraCountLabel");
    const similaritySlider = document.getElementById("similaritySlider");
    const similarityLabel = document.getElementById("similarityLabel");

    function updateIntensityLabel() {
      const map = {
        1: "Chill",
        2: "Cool / casual",
        3: "Heated",
        4: "Meltdown",
      };
      intensityLabel.textContent = map[intensitySlider.value] || "Cool / casual";
    }
    intensitySlider.addEventListener("input", updateIntensityLabel);
    updateIntensityLabel();

    paraSlider.addEventListener("input", () => {
      paraCountLabel.textContent = `(${paraSlider.value})`;
    });

    similaritySlider.addEventListener("input", () => {
      const labels = {
        1: "Very Similar",
        2: "Balanced",
        3: "More Different",
      };
      similarityLabel.textContent = labels[similaritySlider.value];
    });

    /* COPY BUTTON */
    const copyBtn = document.getElementById("copyBtn");
    const copyFlash = document.getElementById("copyFlash");

    copyBtn.addEventListener("click", () => {
      const text = document.getElementById("output").value;
      navigator.clipboard.writeText(text);
      copyFlash.classList.add("show");
      setTimeout(() => copyFlash.classList.remove("show"), 1000);
    });
    /* SAVE RANT */
    const saveRantBtn = document.getElementById("saveRantBtn");

    saveRantBtn.addEventListener("click", () => {
      const text = document.getElementById("output").value.trim();
      if (!text) return alert("Nothing to save!");

      const old = JSON.parse(localStorage.getItem(SAVED_KEY) || "[]");

      old.push({
        text,
        timestamp: Date.now(),
      });

      localStorage.setItem(SAVED_KEY, JSON.stringify(old));
      alert("Saved!");
    });

    /* SHARE PILL BUTTONS */
    const shareButtons = document.querySelectorAll(".share-pill");

    shareButtons.forEach((btn) => {
      btn.addEventListener("click", async () => {
        const net = btn.dataset.network;
        const url = encodeURIComponent(window.location.href);

        if (net === "copy") {
          await navigator.clipboard.writeText(window.location.href);
          btn.classList.add("copied");
          setTimeout(() => btn.classList.remove("copied"), 1200);
          return;
        }

        const MAP = {
          facebook: `https://www.facebook.com/sharer/sharer.php?u=${url}`,
          pinterest: `https://www.pinterest.com/pin/create/button/?url=${url}`,
          instagram: "https://www.instagram.com/", // IG has no direct share URL
          reddit: `https://reddit.com/submit?url=${url}`,
        };

        const shareUrl = MAP[net];
        if (shareUrl) window.open(shareUrl, "_blank");
      });
    });

    /* API KEY PANEL */
    const apiHeader = document.getElementById("apiHeader");
    const apiChevron = document.getElementById("apiChevron");
    const apiBody = document.getElementById("apiBody");

    apiHeader.addEventListener("click", () => {
      apiBody.classList.toggle("open");
      apiChevron.textContent = apiBody.classList.contains("open") ? "‚ñ≤" : "‚ñº";
    });

    /* GROQ API LOGIC */
    const apiKeyInput = document.getElementById("apiKeyInput");
    const saveKeyBtn = document.getElementById("saveKeyBtn");
    const clearKeyBtn = document.getElementById("clearKeyBtn");
    const apiStatus = document.getElementById("apiStatus");
    const toggleKeyBtn = document.getElementById("toggleKeyBtn");

    const API_KEY_LOCAL = "fsg-groq-key";

    function loadApiKey() {
      const key = localStorage.getItem(API_KEY_LOCAL);
      if (key) {
        apiKeyInput.value = key;
        apiStatus.textContent = "API key loaded.";
        apiStatus.className = "api-status ok";
      } else {
        apiStatus.textContent = "No API key saved yet.";
        apiStatus.className = "api-status";
      }
    }

    loadApiKey();

    saveKeyBtn.addEventListener("click", () => {
      localStorage.setItem(API_KEY_LOCAL, apiKeyInput.value.trim());
      apiStatus.textContent = "Saved!";
      apiStatus.className = "api-status ok";
    });

    clearKeyBtn.addEventListener("click", () => {
      localStorage.removeItem(API_KEY_LOCAL);
      apiKeyInput.value = "";
      apiStatus.textContent = "Cleared.";
      apiStatus.className = "api-status err";
    });

    toggleKeyBtn.addEventListener("click", () => {
      const type = apiKeyInput.type === "password" ? "text" : "password";
      apiKeyInput.type = type;
      toggleKeyBtn.innerHTML =
        type === "password"
          ? `<svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 5c-7 0-11 7-11 7s4 7 11 7 11-7 11-7-4-7-11-7zm0 12a5 5 0 110-10 5 5 0 010 10z"/></svg>`
          : `<svg viewBox="0 0 24 24" fill="currentColor"><path d="M2 2l20 20M12 5c7 0 11 7 11 7s-1.1 1.9-3 3.8M6 6C3.9 8 1 12 1 12s4 7 11 7c2.4 0 4.4-.7 6-1.7"/></svg>`;
    });

    /* GENERATION LOGIC */
    const generateBtn = document.getElementById("generateBtn");
    const rewriteBtn = document.getElementById("rewriteBtn");
    const shuffleBtn = document.getElementById("shuffleBtn");
    const uniqueBtn = document.getElementById("uniqueBtn");
    const outputEl = document.getElementById("output");

    const introSelect = document.getElementById("introSelect");
    const customIntroInput = document.getElementById("customIntroInput");
    const topicInput = document.getElementById("topicInput");
    const pasteInput = document.getElementById("pasteInput");
    const narratorSelect = document.getElementById("narratorSelect");
    const slangCheckbox = document.getElementById("includeSlang");
    const swearsCheckbox = document.getElementById("softSwears");

    async function callGroq(prompt) {
      const key = localStorage.getItem(API_KEY_LOCAL);

      if (!key) {
        alert("No Groq API key found! Please enter one in the Groq API section.");
        return "";
      }

      const res = await fetch("https://api.groq.com/openai/v1/chat/completions", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          Authorization: `Bearer ${key}`,
        },
        body: JSON.stringify({
          model: "mixtral-8x7b-32768",
          messages: [
            {
              role: "user",
              content: prompt,
            },
          ],
        }),
      });

      const data = await res.json();
      return data.choices?.[0]?.message?.content || "";
    }

    function buildPrompt(mode = "generate") {
      const introMode = introSelect.value;
      const customIntro = customIntroInput.value.trim();

      const topic = topicInput.value.trim();
      const pasted = pasteInput.value.trim();
      const narrator = narratorSelect.value;
      const slang = slangCheckbox.checked ? "yes" : "no";
      const swears = swearsCheckbox.checked ? "allow" : "no-swears";
      const intensity = intensitySlider.value;
      const paragraphs = paraSlider.value;
      const lang = hiddenLangSelect.value;
      const similarity = similaritySlider.value;

      let opening = "";

      if (introMode === "custom" && customIntro) {
        opening = customIntro;
      } else if (introMode === "throwback") {
        opening = "Throwback to when";
      } else if (introMode === "random") {
        const intros = [
          "Bro, let me be honest...",
          "Honestly, this is wild...",
          "Okay so boom...",
          "Tell me why...",
          "No because listen...",
        ];
        opening = intros[Math.floor(Math.random() * intros.length)];
      } else {
        opening = introMode;
      }

      let prompt = `
You are a Roblox rant generator. Write a rant in ${lang}.
Opening line: "${opening}"
Topic: "${topic}"
Narrator style: ${narrator}
Intensity level: ${intensity}
Paragraph count: ${paragraphs}
Include slang: ${slang}
Swearing: ${swears}
Similarity level: ${similarity}
`;

      if (pasted && mode !== "generate") {
        prompt += `Here is the user‚Äôs pasted rant to rewrite/shuffle/mutate:\n${pasted}\n`;
      }

      if (mode === "rewrite") prompt += "\nRewrite the rant in the same meaning, same vibe.";
      if (mode === "shuffle")
        prompt += "\nShuffle the structure, reorder sentences, but keep meaning.";
      if (mode === "unique") prompt += "\nMake this rant more unique but same theme.";

      prompt += "\nReturn ONLY the rant text. No disclaimers.";

      return prompt;
    }
    async function runGeneration(mode = "generate") {
      outputEl.value = "Generating rant...";
      const prompt = buildPrompt(mode);
      const result = await callGroq(prompt);
      outputEl.value = result || "Error generating rant.";
    }

    generateBtn.addEventListener("click", () => runGeneration("generate"));
    rewriteBtn.addEventListener("click", () => runGeneration("rewrite"));
    shuffleBtn.addEventListener("click", () => runGeneration("shuffle"));
    uniqueBtn.addEventListener("click", () => runGeneration("unique"));

    /* MAKE LANGUAGE DROPDOWN MORE SMOOTH */
    document.addEventListener("keydown", (e) => {
      if (e.key === "Escape") {
        langMenu.style.display = "none";
      }
    });

    /* OPTIONAL IMPROVEMENT: CLOSE DROPDOWN ON SCROLL */
    window.addEventListener("scroll", () => {
      langMenu.style.display = "none";
    });

    /* CLOSE API PANEL ON OUTSIDE CLICK */
    document.addEventListener("click", (e) => {
      if (!apiHeader.contains(e.target) && !apiBody.contains(e.target)) {
        apiBody.classList.remove("open");
        apiChevron.textContent = "‚ñº";
      }
    });
  </script>
</body>
</html>
